{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nclass MiraiWindow {\n  static windowResize(topicId) {\n    try {\n      if (document) {\n        var _document$getElementB, _document$getElementB2;\n        var contentWidth = (_document$getElementB = document.getElementById(topicId)) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.offsetWidth;\n        var contentHeight = (_document$getElementB2 = document.getElementById(topicId)) === null || _document$getElementB2 === void 0 ? void 0 : _document$getElementB2.offsetHeight;\n        if (contentWidth && contentHeight) {\n          window.resizeTo(contentWidth, contentHeight);\n        }\n      }\n    } catch (e) {}\n  }\n  static async open(url, name, topic) {\n    const strWindowFeatures = 'toolbar=no, menubar=no, width=380, height=520, top=200, left=300';\n    let windowObjectReference = window.open(url, name, strWindowFeatures);\n    if (windowObjectReference) {\n      windowObjectReference.focus();\n      window.addEventListener('message', event => {\n        const {\n          data\n        } = event;\n        const {\n          topicId,\n          message\n        } = data;\n        if (topicId === topic) {\n          if (message === 'user_approved' || message === 'user_rejected') {\n            windowObjectReference === null || windowObjectReference === void 0 ? void 0 : windowObjectReference.close();\n          }\n        }\n      });\n      window.addEventListener('message', e => {\n        const {\n          data\n        } = e;\n        console.log(data);\n        const {\n          event\n        } = data;\n        if (event === 'window_closed') {\n          window.postMessage({\n            topic,\n            message: 'window_closed'\n          });\n        }\n      });\n      this.currentWindow = windowObjectReference;\n    }\n  }\n  static async close() {\n    this.currentWindow.close();\n  }\n}\n// eslint-disable-next-line no-undef\n_defineProperty(MiraiWindow, \"currentWindow\", void 0);\nexport default MiraiWindow;","map":{"version":3,"names":["MiraiWindow","windowResize","topicId","document","_document$getElementB","_document$getElementB2","contentWidth","getElementById","offsetWidth","contentHeight","offsetHeight","window","resizeTo","e","open","url","name","topic","strWindowFeatures","windowObjectReference","focus","addEventListener","event","data","message","close","console","log","postMessage","currentWindow","_defineProperty"],"sources":["/Users/phuocnd/phuocnd/works/mirai/miraiidjs/src/shared/ui/mirai-window.ts"],"sourcesContent":["class MiraiWindow {\n\t// eslint-disable-next-line no-undef\n\tpublic static currentWindow: Window;\n\n\tstatic windowResize(topicId: string) {\n\t\ttry {\n\t\t\tif (document) {\n\t\t\t\tvar contentWidth = document.getElementById(topicId)?.offsetWidth;\n\t\t\t\tvar contentHeight = document.getElementById(topicId)?.offsetHeight;\n\t\t\t\tif (contentWidth && contentHeight) {\n\t\t\t\t\twindow.resizeTo(contentWidth, contentHeight);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {}\n\t}\n\n\tstatic async open(url: string, name: string, topic: string) {\n\t\tconst strWindowFeatures = 'toolbar=no, menubar=no, width=380, height=520, top=200, left=300';\n\n\t\tlet windowObjectReference = window.open(url, name, strWindowFeatures);\n\n\t\tif (windowObjectReference) {\n\t\t\twindowObjectReference.focus();\n\n\t\t\twindow.addEventListener('message', (event) => {\n\t\t\t\tconst { data } = event;\n\t\t\t\tconst { topicId, message } = data;\n\n\t\t\t\tif (topicId === topic) {\n\t\t\t\t\tif (message === 'user_approved' || message === 'user_rejected') {\n\t\t\t\t\t\twindowObjectReference?.close();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\twindow.addEventListener('message', (e) => {\n\t\t\t\tconst { data } = e;\n\t\t\t\tconsole.log(data);\n\t\t\t\tconst { event } = data;\n\t\t\t\tif (event === 'window_closed') {\n\t\t\t\t\twindow.postMessage({ topic, message: 'window_closed' });\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.currentWindow = windowObjectReference;\n\t\t}\n\t}\n\n\tstatic async close() {\n\t\tthis.currentWindow.close();\n\t}\n}\n\nexport default MiraiWindow;\n"],"mappings":";AAAA,MAAMA,WAAW,CAAC;EAIjB,OAAOC,YAAYA,CAACC,OAAe,EAAE;IACpC,IAAI;MACH,IAAIC,QAAQ,EAAE;QAAA,IAAAC,qBAAA,EAAAC,sBAAA;QACb,IAAIC,YAAY,IAAAF,qBAAA,GAAGD,QAAQ,CAACI,cAAc,CAACL,OAAO,CAAC,cAAAE,qBAAA,uBAAhCA,qBAAA,CAAkCI,WAAW;QAChE,IAAIC,aAAa,IAAAJ,sBAAA,GAAGF,QAAQ,CAACI,cAAc,CAACL,OAAO,CAAC,cAAAG,sBAAA,uBAAhCA,sBAAA,CAAkCK,YAAY;QAClE,IAAIJ,YAAY,IAAIG,aAAa,EAAE;UAClCE,MAAM,CAACC,QAAQ,CAACN,YAAY,EAAEG,aAAa,CAAC;QAC7C;MACD;IACD,CAAC,CAAC,OAAOI,CAAC,EAAE,CAAC;EACd;EAEA,aAAaC,IAAIA,CAACC,GAAW,EAAEC,IAAY,EAAEC,KAAa,EAAE;IAC3D,MAAMC,iBAAiB,GAAG,kEAAkE;IAE5F,IAAIC,qBAAqB,GAAGR,MAAM,CAACG,IAAI,CAACC,GAAG,EAAEC,IAAI,EAAEE,iBAAiB,CAAC;IAErE,IAAIC,qBAAqB,EAAE;MAC1BA,qBAAqB,CAACC,KAAK,CAAC,CAAC;MAE7BT,MAAM,CAACU,gBAAgB,CAAC,SAAS,EAAGC,KAAK,IAAK;QAC7C,MAAM;UAAEC;QAAK,CAAC,GAAGD,KAAK;QACtB,MAAM;UAAEpB,OAAO;UAAEsB;QAAQ,CAAC,GAAGD,IAAI;QAEjC,IAAIrB,OAAO,KAAKe,KAAK,EAAE;UACtB,IAAIO,OAAO,KAAK,eAAe,IAAIA,OAAO,KAAK,eAAe,EAAE;YAC/DL,qBAAqB,aAArBA,qBAAqB,uBAArBA,qBAAqB,CAAEM,KAAK,CAAC,CAAC;UAC/B;QACD;MACD,CAAC,CAAC;MAEFd,MAAM,CAACU,gBAAgB,CAAC,SAAS,EAAGR,CAAC,IAAK;QACzC,MAAM;UAAEU;QAAK,CAAC,GAAGV,CAAC;QAClBa,OAAO,CAACC,GAAG,CAACJ,IAAI,CAAC;QACjB,MAAM;UAAED;QAAM,CAAC,GAAGC,IAAI;QACtB,IAAID,KAAK,KAAK,eAAe,EAAE;UAC9BX,MAAM,CAACiB,WAAW,CAAC;YAAEX,KAAK;YAAEO,OAAO,EAAE;UAAgB,CAAC,CAAC;QACxD;MACD,CAAC,CAAC;MAEF,IAAI,CAACK,aAAa,GAAGV,qBAAqB;IAC3C;EACD;EAEA,aAAaM,KAAKA,CAAA,EAAG;IACpB,IAAI,CAACI,aAAa,CAACJ,KAAK,CAAC,CAAC;EAC3B;AACD;AAlDC;AAAAK,eAAA,CADK9B,WAAW;AAqDjB,eAAeA,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}