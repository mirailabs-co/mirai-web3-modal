{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport { AuthToken } from '../../../auth-client';\nexport class BaseWebSocketService {\n  constructor(opts) {\n    _defineProperty(this, \"getHeaders\", async authToken => {\n      const authHeaders = {};\n      if (authToken) {\n        authHeaders.authorization = \"\".concat(authToken);\n        return authHeaders;\n      }\n      const token = await AuthToken.get();\n      if (token) {\n        authHeaders.authorization = \"\".concat(token.access_token);\n      }\n      return authHeaders;\n    });\n    this.initialize();\n  }\n  initialize() {\n    try {\n      AuthToken.initInstanceStorage();\n    } catch {}\n  }\n}","map":{"version":3,"names":["AuthToken","BaseWebSocketService","constructor","opts","_defineProperty","authToken","authHeaders","authorization","concat","token","get","access_token","initialize","initInstanceStorage"],"sources":["/Users/phuocnd/phuocnd/works/mirai/miraiidjs/src/sign-provider/transports/websocket/ws-base.ts"],"sourcesContent":["import { AuthToken } from '../../../auth-client';\nimport { WebSocketConnection } from './connection-wrapper';\nimport { auth } from '../../../constants';\n\nexport type IWSOpts = {\n\turl: string;\n\taccessToken: string;\n};\n\nexport abstract class BaseWebSocketService {\n\tconstructor(opts: IWSOpts) {\n\t\tthis.initialize();\n\t}\n\n\tinitialize() {\n\t\ttry {\n\t\t\tAuthToken.initInstanceStorage();\n\t\t} catch {}\n\t}\n\tprotected getHeaders = async (authToken?: string) => {\n\t\tconst authHeaders: Record<string, string> = {};\n\n\t\tif (authToken) {\n\t\t\tauthHeaders.authorization = `${authToken}`;\n\t\t\treturn authHeaders;\n\t\t}\n\n\t\tconst token = await AuthToken.get();\n\t\tif (token) {\n\t\t\tauthHeaders.authorization = `${token.access_token}`;\n\t\t}\n\n\t\treturn authHeaders;\n\t};\n\n\tpublic abstract establish(): Promise<WebSocketConnection>;\n}\n"],"mappings":";AAAA,SAASA,SAAS,QAAQ,sBAAsB;AAShD,OAAO,MAAeC,oBAAoB,CAAC;EAC1CC,WAAWA,CAACC,IAAa,EAAE;IAAAC,eAAA,qBASJ,MAAOC,SAAkB,IAAK;MACpD,MAAMC,WAAmC,GAAG,CAAC,CAAC;MAE9C,IAAID,SAAS,EAAE;QACdC,WAAW,CAACC,aAAa,MAAAC,MAAA,CAAMH,SAAS,CAAE;QAC1C,OAAOC,WAAW;MACnB;MAEA,MAAMG,KAAK,GAAG,MAAMT,SAAS,CAACU,GAAG,CAAC,CAAC;MACnC,IAAID,KAAK,EAAE;QACVH,WAAW,CAACC,aAAa,MAAAC,MAAA,CAAMC,KAAK,CAACE,YAAY,CAAE;MACpD;MAEA,OAAOL,WAAW;IACnB,CAAC;IAtBA,IAAI,CAACM,UAAU,CAAC,CAAC;EAClB;EAEAA,UAAUA,CAAA,EAAG;IACZ,IAAI;MACHZ,SAAS,CAACa,mBAAmB,CAAC,CAAC;IAChC,CAAC,CAAC,MAAM,CAAC;EACV;AAkBD"},"metadata":{},"sourceType":"module","externalDependencies":[]}